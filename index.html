<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Green Star Solar - Solar Panels for Your Home | Expert Installation & Design</title>
    <meta name="description" content="With energy prices at an all-time high, invest in premium solar panels and battery storage. Custom-designed systems with Aiko Neostar panels and Fox ESS batteries. Expert installation, 25-year warranty.">
    
    <!-- Preload Critical Resources -->
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Playfair+Display:wght@400;500;600;700&display=swap" as="style">
    <link rel="preload" href="https://lirp.cdn-website.com/8f142869/dms3rep/multi/opt/Greenstar_Solar_Logo_WHITE.TAG_STACKED-3x-488w.png" as="image">
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Playfair+Display:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Critical CSS -->
    <style>
        /* Color Palette CSS Custom Properties */
        :root {
            /* Primary Colors */
            --charcoal: #444c5c;
            --charcoal-100: #0d0f12;
            --charcoal-200: #1b1e24;
            --charcoal-300: #282d37;
            --charcoal-400: #363c49;
            --charcoal-500: #444c5c;
            --charcoal-600: #616d83;
            --charcoal-700: #8690a5;
            --charcoal-800: #aeb5c3;
            --charcoal-900: #d7dae1;
            
            --sage: #adae88;
            --sage-100: #252519;
            --sage-200: #494a32;
            --sage-300: #6e6f4c;
            --sage-400: #939465;
            --sage-500: #adae88;
            --sage-600: #bebfa0;
            --sage-700: #cecfb8;
            --sage-800: #dedfd0;
            --sage-900: #efefe7;
            
            --black-olive: #2c3421;
            --black-olive-100: #090b07;
            --black-olive-200: #12150e;
            --black-olive-300: #1b2014;
            --black-olive-400: #242a1b;
            --black-olive-500: #2c3421;
            --black-olive-600: #596943;
            --black-olive-700: #859c64;
            --black-olive-800: #adbd98;
            --black-olive-900: #d6decb;
            
            --black: #06070a;
            --black-100: #010102;
            --black-200: #020304;
            --black-300: #030406;
            --black-400: #050508;
            --black-500: #06070a;
            --black-600: #2b3247;
            --black-700: #505d85;
            --black-800: #8390b5;
            --black-900: #c1c7da;
            
            --outer-space: #4b5961;
            --outer-space-100: #0f1214;
            --outer-space-200: #1e2427;
            --outer-space-300: #2d363b;
            --outer-space-400: #3c484e;
            --outer-space-500: #4b5961;
            --outer-space-600: #697d88;
            --outer-space-700: #8d9ea7;
            --outer-space-800: #b3bec4;
            --outer-space-900: #d9dfe2;
        }

        /* Base Reset */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        html {
            scroll-behavior: smooth;
            font-size: 16px;
        }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            color: var(--charcoal-500);
            background-color: var(--charcoal-900);
            overflow-x: hidden;
        }

        /* Typography */
        h1, h2, h3, h4, h5, h6 {
            font-family: 'Playfair Display', serif;
            font-weight: 600;
            line-height: 1.2;
            color: var(--charcoal-500);
        }

        .text-sage { color: var(--sage-500); }
        .text-charcoal { color: var(--charcoal-500); }
        .text-black-olive { color: var(--black-olive-500); }
        .text-outer-space { color: var(--outer-space-500); }
        .text-white { color: white; }

        /* Navigation */
        .nav {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: rgba(68, 76, 92, 0.95);
            backdrop-filter: blur(15px);
            z-index: 1000;
            padding: 1rem 0;
            transform: translateY(-100%);
            transition: transform 0.3s ease;
            border-bottom: 1px solid var(--sage-700);
        }
        
        .nav.visible {
            transform: translateY(0);
        }
        
        .nav-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 2rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .logo img {
            height: 50px;
            width: auto;
            filter: brightness(0) invert(1);
        }
        
        .nav-links {
            display: flex;
            list-style: none;
            gap: 2.5rem;
        }
        
        .nav-links a {
            text-decoration: none;
            color: white;
            font-weight: 500;
            font-size: 0.95rem;
            transition: color 0.3s ease;
            position: relative;
        }
        
        .nav-links a:hover {
            color: var(--sage-500);
        }

        .nav-links a::after {
            content: '';
            position: absolute;
            width: 0;
            height: 2px;
            bottom: -5px;
            left: 0;
            background: var(--sage-500);
            transition: width 0.3s ease;
        }

        .nav-links a:hover::after {
            width: 100%;
        }

        /* Hero Section */
        .hero {
            min-height: 100vh;
            background: linear-gradient(135deg, var(--charcoal-200) 0%, var(--outer-space-300) 50%, var(--black-olive-400) 100%);
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }

        .hero::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 1000"><defs><pattern id="grid" width="60" height="60" patternUnits="userSpaceOnUse"><path d="M 60 0 L 0 0 0 60" fill="none" stroke="rgba(173,174,136,0.1)" stroke-width="1"/></pattern></defs><rect width="100%" height="100%" fill="url(%23grid)"/></svg>');
        }

        .hero-content {
            text-align: center;
            z-index: 2;
            position: relative;
            max-width: 1000px;
            padding: 2rem;
        }

        .hero-logo {
            margin-bottom: 3rem;
        }

        .hero-logo img {
            height: clamp(100px, 20vw, 160px);
            width: auto;
            filter: drop-shadow(0 10px 30px rgba(0, 0, 0, 0.3));
        }

        .hero-title {
            font-size: clamp(2.5rem, 8vw, 5rem);
            font-weight: 700;
            color: white;
            margin-bottom: 1.5rem;
            text-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        }

        .hero-subtitle {
            font-size: clamp(1.1rem, 3vw, 1.8rem);
            color: var(--sage-800);
            margin-bottom: 3rem;
            font-weight: 300;
            line-height: 1.5;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
            text-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        /* Container */
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 2rem;
        }

        /* Section Styles */
        .section {
            padding: 6rem 0;
        }

        .section-title {
            font-size: clamp(2.5rem, 6vw, 4rem);
            font-weight: 700;
            margin-bottom: 1.5rem;
            text-align: center;
            color: var(--charcoal-500);
        }

        .section-subtitle {
            font-size: clamp(1.1rem, 2.5vw, 1.4rem);
            color: var(--outer-space-600);
            text-align: center;
            margin-bottom: 4rem;
            max-width: 700px;
            margin-left: auto;
            margin-right: auto;
        }

        /* Buttons */
        .btn {
            display: inline-block;
            padding: 1rem 2.5rem;
            border-radius: 50px;
            text-decoration: none;
            font-weight: 600;
            text-align: center;
            transition: all 0.3s ease;
            border: 2px solid transparent;
            cursor: pointer;
            font-size: 1.1rem;
            position: relative;
            overflow: hidden;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--sage-500), var(--sage-600));
            color: var(--charcoal-500);
            box-shadow: 0 10px 30px rgba(173, 174, 136, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 40px rgba(173, 174, 136, 0.4);
            background: linear-gradient(135deg, var(--sage-600), var(--sage-700));
        }

        .btn-secondary {
            background: transparent;
            color: white;
            border-color: var(--sage-600);
            backdrop-filter: blur(10px);
        }

        .btn-secondary:hover {
            background: var(--sage-500);
            color: var(--charcoal-500);
            transform: translateY(-2px);
        }

        /* Mobile Menu */
        .mobile-menu {
            display: none;
            background: none;
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            padding: 0.5rem;
        }

        @media (max-width: 768px) {
            .nav-links {
                display: none;
            }
            
            .mobile-menu {
                display: block;
            }
        }
    </style>
</head>

<body>
    <!-- Loading Screen -->
    <div class="loading" id="loading">
        <div class="spinner"></div>
    </div>

    <!-- Navigation -->
    <nav class="nav" id="nav">
        <div class="nav-container">
            <div class="logo">
                <img src="https://lirp.cdn-website.com/8f142869/dms3rep/multi/opt/Greenstar_Solar_Logo_WHITE.TAG_STACKED-3x-488w.png" alt="Green Star Solar" id="nav-logo">
            </div>
            <ul class="nav-links">
                <li><a href="#home">Home</a></li>
                <li><a href="#about">About</a></li>
                <li><a href="#solar-systems">Solar Systems</a></li>
                <li><a href="#battery-storage">Battery Storage</a></li>
                <li><a href="#benefits">Benefits</a></li>
                <li><a href="#process">Process</a></li>
                <li><a href="#contact">Contact</a></li>
            </ul>
            <button class="mobile-menu" id="mobile-menu">☰</button>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="hero" id="home">
        <div class="hero-content">
            <div class="hero-logo">
                <img src="https://lirp.cdn-website.com/8f142869/dms3rep/multi/opt/Greenstar_Solar_Logo_WHITE.TAG_STACKED-3x-488w.png" alt="Green Star Solar">
            </div>
            <h1 class="hero-title">SOLAR PANELS FOR YOUR HOME</h1>
            <p class="hero-subtitle">With energy prices at an all-time high, now is an ideal time to invest in solar panels and battery storage. We offer custom-designed systems featuring highly efficient Aiko Neostar 2S N-type mono glass panels, paired with the latest hybrid inverters and batteries from leading brands.</p>
            <div class="hero-cta">
                <a href="#contact" class="btn btn-primary">Get Free Quote</a>
                <a href="#solar-systems" class="btn btn-secondary">Explore Systems</a>
            </div>
        </div>
        <div class="scroll-indicator">
            <div class="scroll-arrow"></div>
        </div>
    </section>

    <!-- About Section -->
    <section class="section" style="background: var(--charcoal-900);" id="about">
        <div class="container">
            <div class="section-header">
                <h2 class="section-title">Leading Solar Innovation</h2>
                <p class="section-subtitle">Our goal is to design and install a solar energy system that perfectly matches your unique energy goals</p>
            </div>
            
            <div class="about-grid">
                <div class="about-content">
                    <div class="stats-grid">
                        <div class="stat-card">
                            <h3>25</h3>
                            <p>Year Product Warranty</p>
                        </div>
                        <div class="stat-card">
                            <h3>30</h3>
                            <p>Year Performance Warranty</p>
                        </div>
                        <div class="stat-card">
                            <h3>23.1%</h3>
                            <p>Panel Efficiency</p>
                        </div>
                    </div>
                </div>
                
                <div class="about-text">
                    <h3>Why Choose Green Star Solar?</h3>
                    <p>We specialize in designing and installing premium solar energy systems using the latest technology. Our custom-designed systems feature highly efficient Aiko Neostar 2S N-type mono glass panels, known for their ethical sourcing and top-tier performance.</p>
                    
                    <div class="features-list">
                        <div class="feature-item">
                            <span class="feature-icon">✓</span>
                            <span>Expert design and consultation</span>
                        </div>
                        <div class="feature-item">
                            <span class="feature-icon">✓</span>
                            <span>Premium Aiko Neostar panels</span>
                        </div>
                        <div class="feature-item">
                            <span class="feature-icon">✓</span>
                            <span>Fox ESS, SolarEdge, EcoFlow batteries</span>
                        </div>
                        <div class="feature-item">
                            <span class="feature-icon">✓</span>
                            <span>25-year product warranty</span>
                        </div>
                        <div class="feature-item">
                            <span class="feature-icon">✓</span>
                            <span>Professional installation</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Solar Panel Specifications -->
    <section class="section" style="background: linear-gradient(135deg, var(--sage-800) 0%, var(--sage-700) 100%); color: var(--charcoal-500);" id="solar-systems">
        <div class="container">
            <div class="section-header">
                <h2 class="section-title">Premium Aiko Neostar 2S Panels</h2>
                <p class="section-subtitle">State-of-the-art N-type mono glass panels with industry-leading specifications</p>
            </div>
            
            <div class="panel-specs">
                <div class="spec-grid">
                    <div class="spec-card">
                        <div class="spec-icon">⚡</div>
                        <h4>Efficiency</h4>
                        <p>Up to 23.1%</p>
                    </div>
                    <div class="spec-card">
                        <div class="spec-icon">📉</div>
                        <h4>Low Degradation</h4>
                        <p>≤1% first year, ≤0.3% annually</p>
                    </div>
                    <div class="spec-card">
                        <div class="spec-icon">🛡️</div>
                        <h4>Premium Warranty</h4>
                        <p>25-year product, 30-year performance</p>
                    </div>
                    <div class="spec-card">
                        <div class="spec-icon">🌡️</div>
                        <h4>Temperature Coefficient</h4>
                        <p>-0.26%/°C</p>
                    </div>
                    <div class="spec-card">
                        <div class="spec-icon">🌤️</div>
                        <h4>Shading Optimization</h4>
                        <p>Built-in cell optimization</p>
                    </div>
                    <div class="spec-card">
                        <div class="spec-icon">🔧</div>
                        <h4>Lower Maintenance</h4>
                        <p>High temperature & micro-crack resistance</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Battery Storage Section -->
    <section class="section" style="background: var(--charcoal-900);" id="battery-storage">
        <div class="container">
            <div class="section-header">
                <h2 class="section-title">Battery Storage Solutions</h2>
                <p class="section-subtitle">Solar battery storage enhances efficiency and value by storing excess energy for use during peak times or at night</p>
            </div>
            
            <div class="battery-benefits">
                <div class="benefit-grid">
                    <div class="benefit-card">
                        <div class="benefit-number">1</div>
                        <div class="benefit-content">
                            <h3>Energy Independence</h3>
                            <p>If you don't have a battery, and your panels don't produce enough energy for your needs, your system draws on the grid, and you pay for this electricity. Batteries give you much more control over your energy because they reduce your vulnerability to peak time electricity prices. They can also power your home during a power cut.</p>
                        </div>
                    </div>
                    
                    <div class="benefit-card">
                        <div class="benefit-number">2</div>
                        <div class="benefit-content">
                            <h3>Store Cheap Grid Energy</h3>
                            <p>Although it may be difficult to believe during the current energy crisis when rates are so high, energy prices fall overnight to as low as 7 pence per kWh, and energy suppliers are paid to take energy off the grid. Use the app to charge your batteries with cheap overnight electricity for use during peak rate times.</p>
                        </div>
                    </div>
                    
                    <div class="benefit-card">
                        <div class="benefit-number">3</div>
                        <div class="benefit-content">
                            <h3>Increase Property Value</h3>
                            <p>Solar batteries bring your property closer to energy independence and self-sufficiency. Solar energy creates far less pollution than fossil fuels and reduces your home's carbon footprint for years. They also improve your home's EPC rating and its value.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Benefits Section -->
    <section class="section" style="background: linear-gradient(135deg, var(--black-olive-800) 0%, var(--black-olive-700) 100%); color: var(--charcoal-500);" id="benefits">
        <div class="container">
            <div class="benefits-content">
                <div class="benefits-text">
                    <h2 class="section-title">Why Go Solar?</h2>
                    
                    <div class="benefit-items">
                        <div class="benefit-item">
                            <div class="benefit-icon">💰</div>
                            <div class="benefit-detail">
                                <h3>Massive Savings</h3>
                                <p>Reduce your electricity bills by up to 90% and protect against rising energy costs with our efficient solar solutions.</p>
                            </div>
                        </div>
                        
                        <div class="benefit-item">
                            <div class="benefit-icon">🌍</div>
                            <div class="benefit-detail">
                                <h3>Environmental Impact</h3>
                                <p>Significantly reduce your carbon footprint and contribute to a sustainable future with clean solar energy.</p>
                            </div>
                        </div>
                        
                        <div class="benefit-item">
                            <div class="benefit-icon">📈</div>
                            <div class="benefit-detail">
                                <h3>Increase Property Value</h3>
                                <p>Solar installations improve your home's EPC rating and can increase property value due to energy efficiency.</p>
                            </div>
                        </div>
                        
                        <div class="benefit-item">
                            <div class="benefit-icon">⚡</div>
                            <div class="benefit-detail">
                                <h3>Energy Independence</h3>
                                <p>Generate your own clean energy and reduce dependence on the grid with battery storage solutions.</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="savings-calculator">
                    <h3>Potential Savings Calculator</h3>
                    <div class="calc-input">
                        <label for="monthly-bill">Monthly Electricity Bill (£)</label>
                        <input type="number" id="monthly-bill" placeholder="150" value="150">
                    </div>
                    <div class="calc-result">
                        <div class="savings-item">
                            <span>Annual Savings:</span>
                            <span id="annual-savings">£1,350</span>
                        </div>
                        <div class="savings-item highlight">
                            <span>25-Year Savings:</span>
                            <span id="total-savings">£33,750</span>
                        </div>
                    </div>
                    <button class="btn btn-primary full-width" onclick="openQuoteForm()">Get Accurate Quote</button>
                </div>
            </div>
        </div>
    </section>

    <!-- Process Section -->
    <section class="section" style="background: var(--charcoal-900);" id="process">
        <div class="container">
            <div class="section-header">
                <h2 class="section-title">Our Proven Process</h2>
                <p class="section-subtitle">From initial consultation to system activation in 4 simple steps</p>
            </div>
            
            <div class="process-timeline">
                <div class="process-step">
                    <div class="step-number">1</div>
                    <div class="step-content">
                        <h3>Free Consultation</h3>
                        <p>We assess your energy needs, roof suitability, and financial goals to design the perfect system tailored to your home.</p>
                    </div>
                </div>
                
                <div class="process-step">
                    <div class="step-number">2</div>
                    <div class="step-content">
                        <h3>Custom Design</h3>
                        <p>Our engineers create a detailed system design optimized for your specific property using Aiko Neostar panels and premium components.</p>
                    </div>
                </div>
                
                <div class="process-step">
                    <div class="step-number">3</div>
                    <div class="step-content">
                        <h3>Professional Installation</h3>
                        <p>Our certified installers complete the installation with minimal disruption, ensuring safety and optimal performance.</p>
                    </div>
                </div>
                
                <div class="process-step">
                    <div class="step-number">4</div>
                    <div class="step-content">
                        <h3>System Activation</h3>
                        <p>We handle all paperwork, permits, and grid connection for seamless activation and ongoing support.</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Contact Section -->
    <section class="section" style="background: linear-gradient(135deg, var(--outer-space-300) 0%, var(--charcoal-300) 100%); color: white;" id="contact">
        <div class="container">
            <div class="contact-content">
                <div class="contact-info">
                    <h2 class="section-title text-white">Get Your Free Quote</h2>
                    <p style="color: var(--sage-800);">Ready to start your solar journey? Contact us today for a free, no-obligation consultation and personalized quote.</p>
                    
                    <div class="contact-methods">
                        <div class="contact-method">
                            <div class="contact-icon">📍</div>
                            <div>
                                <h4>Address</h4>
                                <p>Greenstar<br>
                                4500 Parkway<br>
                                Solent Business Park<br>
                                Whiteley</p>
                            </div>
                        </div>
                        
                        <div class="contact-method">
                            <div class="contact-icon">📞</div>
                            <div>
                                <h4>Call Us</h4>
                                <p>0800 123 4567</p>
                            </div>
                        </div>
                        
                        <div class="contact-method">
                            <div class="contact-icon">✉️</div>
                            <div>
                                <h4>Email Us</h4>
                                <p>info@greenstarsolar.co.uk</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <form class="contact-form" id="quote-form">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="name">Full Name *</label>
                            <input type="text" id="name" name="name" required>
                        </div>
                        <div class="form-group">
                            <label for="email">Email *</label>
                            <input type="email" id="email" name="email" required>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="phone">Phone *</label>
                            <input type="tel" id="phone" name="phone" required>
                        </div>
                        <div class="form-group">
                            <label for="postcode">Postcode *</label>
                            <input type="text" id="postcode" name="postcode" required>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="property-type">Property Type</label>
                        <select id="property-type" name="property-type">
                            <option value="detached">Detached House</option>
                            <option value="semi-detached">Semi-Detached House</option>
                            <option value="terraced">Terraced House</option>
                            <option value="bungalow">Bungalow</option>
                            <option value="commercial">Commercial Property</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="monthly-bill-form">Monthly Electricity Bill (£)</label>
                        <input type="number" id="monthly-bill-form" name="monthly-bill" placeholder="150">
                    </div>
                    
                    <div class="form-group">
                        <label for="message">Additional Information</label>
                        <textarea id="message" name="message" rows="4" placeholder="Tell us about your energy goals or any specific requirements..."></textarea>
                    </div>
                    
                    <button type="submit" class="btn btn-primary full-width">Get My Free Quote</button>
                    
                    <p class="form-disclaimer">
                        By submitting this form, you agree to be contacted by Green Star Solar regarding your solar inquiry.
                    </p>
                </form>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <div class="footer-logo">
                        <img src="https://lirp.cdn-website.com/8f142869/dms3rep/multi/opt/Greenstar_Solar_Logo_WHITE.TAG_STACKED-3x-488w.png" alt="Green Star Solar">
                    </div>
                    <p>Leading the UK's transition to sustainable solar energy with premium Aiko Neostar installations and expert service.</p>
                </div>
                
                <div class="footer-section">
                    <h4>Services</h4>
                    <ul>
                        <li><a href="#solar-systems">Solar Panel Systems</a></li>
                        <li><a href="#battery-storage">Battery Storage</a></li>
                        <li><a href="#benefits">Energy Solutions</a></li>
                        <li><a href="#process">Installation Process</a></li>
                    </ul>
                </div>
                
                <div class="footer-section">
                    <h4>Company</h4>
                    <ul>
                        <li><a href="#about">About Us</a></li>
                        <li><a href="#process">Our Process</a></li>
                        <li><a href="privacy-policy.html">Privacy Policy</a></li>
                        <li><a href="#contact">Contact</a></li>
                    </ul>
                </div>
                
                <div class="footer-section">
                    <h4>Contact Info</h4>
                    <ul>
                        <li>📞 0800 123 4567</li>
                        <li>✉️ info@greenstarsolar.co.uk</li>
                        <li>📍 Solent Business Park, Whiteley</li>
                    </ul>
                </div>
            </div>
            
            <div class="footer-bottom">
                <p>&copy; 2025 Green Star Solar. All rights reserved.</p>
                <div class="social-links">
                    <a href="#" aria-label="Facebook">📘</a>
                    <a href="#" aria-label="Twitter">🐦</a>
                    <a href="#" aria-label="LinkedIn">💼</a>
                    <a href="#" aria-label="Instagram">📸</a>
                </div>
            </div>
        </div>
    </footer>

    <!-- Main Stylesheet -->
    <style>
        /* About Section Styles */
        .about-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 5rem;
            align-items: start;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: var(--sage-800);
            padding: 2rem 1.5rem;
            border-radius: 20px;
            text-align: center;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            border: 1px solid var(--sage-700);
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(173, 174, 136, 0.2);
        }

        .stat-card h3 {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--charcoal-500);
            margin-bottom: 0.5rem;
        }

        .stat-card p {
            color: var(--charcoal-600);
            font-size: 0.9rem;
            font-weight: 500;
        }

        .about-text h3 {
            font-size: 2.2rem;
            color: var(--charcoal-500);
            margin-bottom: 1.5rem;
        }

        .about-text p {
            color: var(--outer-space-600);
            margin-bottom: 2rem;
            line-height: 1.7;
            font-size: 1.1rem;
        }

        .features-list {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .feature-item {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 0.8rem;
            background: var(--sage-900);
            border-radius: 10px;
            transition: transform 0.2s ease;
        }

        .feature-item:hover {
            transform: translateX(5px);
        }

        .feature-icon {
            color: var(--sage-500);
            font-size: 1.2rem;
            min-width: 20px;
            font-weight: bold;
        }

        /* Panel Specifications */
        .spec-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 2rem;
        }

        .spec-card {
            background: rgba(68, 76, 92, 0.8);
            backdrop-filter: blur(10px);
            padding: 2.5rem 2rem;
            border-radius: 20px;
            text-align: center;
            transition: transform 0.3s ease;
            border: 1px solid rgba(173, 174, 136, 0.3);
        }

        .spec-card:hover {
            transform: translateY(-10px);
        }

        .spec-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
        }

        .spec-card h4 {
            font-size: 1.3rem;
            margin-bottom: 1rem;
            color: var(--charcoal-500);
        }

        .spec-card p {
            color: var(--charcoal-700);
            font-weight: 500;
        }

        /* Battery Benefits */
        .benefit-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 2rem;
            max-width: 900px;
            margin: 0 auto;
        }

        .benefit-card {
            display: flex;
            gap: 2rem;
            background: var(--sage-800);
            padding: 2.5rem;
            border-radius: 20px;
            transition: transform 0.3s ease;
            border: 1px solid var(--sage-700);
        }

        .benefit-card:hover {
            transform: translateX(10px);
        }

        .benefit-number {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--charcoal-500);
            background: var(--sage-600);
            width: 80px;
            height: 80px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .benefit-content h3 {
            color: var(--charcoal-500);
            margin-bottom: 1rem;
            font-size: 1.5rem;
        }

        .benefit-content p {
            color: var(--charcoal-600);
            line-height: 1.6;
        }

        /* Benefits Section */
        .benefits-content {
            display: grid;
            grid-template-columns: 1fr 400px;
            gap: 4rem;
            align-items: start;
        }

        .benefit-items {
            display: flex;
            flex-direction: column;
            gap: 2rem;
        }

        .benefit-item {
            display: flex;
            gap: 1.5rem;
            padding: 2rem;
            background: rgba(68, 76, 92, 0.8);
            border-radius: 15px;
            transition: transform 0.3s ease;
            border: 1px solid rgba(173, 174, 136, 0.3);
        }

        .benefit-item:hover {
            transform: translateX(10px);
        }

        .benefit-icon {
            font-size: 2.5rem;
            min-width: 60px;
        }

        .benefit-detail h3 {
            font-size: 1.4rem;
            color: var(--charcoal-500);
            margin-bottom: 0.5rem;
        }

        .benefit-detail p {
            color: var(--charcoal-700);
            line-height: 1.5;
        }

        /* Savings Calculator */
        .savings-calculator {
            background: var(--sage-800);
            padding: 2.5rem;
            border-radius: 20px;
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 2rem;
            border: 1px solid var(--sage-700);
        }

        .savings-calculator h3 {
            color: var(--charcoal-500);
            margin-bottom: 2rem;
            text-align: center;
            font-size: 1.5rem;
        }

        .calc-input {
            margin-bottom: 2rem;
        }

        .calc-input label {
            display: block;
            margin-bottom: 0.5rem;
            color: var(--charcoal-500);
            font-weight: 500;
        }

        .calc-input input {
            width: 100%;
            padding: 1rem;
            border: 2px solid var(--sage-600);
            border-radius: 10px;
            font-size: 1.1rem;
            transition: border-color 0.3s ease;
            background: var(--sage-900);
            color: var(--charcoal-500);
        }

        .calc-input input:focus {
            outline: none;
            border-color: var(--charcoal-500);
        }

        .calc-result {
            margin-bottom: 2rem;
        }

        .savings-item {
            display: flex;
            justify-content: space-between;
            padding: 1rem;
            background: var(--sage-900);
            margin-bottom: 0.5rem;
            border-radius: 10px;
            font-weight: 500;
            color: var(--charcoal-500);
        }

        .savings-item.highlight {
            background: var(--charcoal-500);
            color: white;
            font-size: 1.1rem;
        }

        /* Process Timeline */
        .process-timeline {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 2rem;
            max-width: 1200px;
            margin: 0 auto;
        }

        .process-step {
            text-align: center;
            position: relative;
        }

        .step-number {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, var(--sage-500), var(--sage-600));
            color: var(--charcoal-500);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            font-weight: 700;
            margin: 0 auto 2rem;
            box-shadow: 0 10px 30px rgba(173, 174, 136, 0.3);
        }

        .step-content h3 {
            color: var(--charcoal-500);
            margin-bottom: 1rem;
            font-size: 1.4rem;
        }

        .step-content p {
            color: var(--outer-space-600);
            line-height: 1.6;
        }

        /* Contact Section */
        .contact-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 4rem;
            align-items: start;
        }

        .contact-methods {
            margin-top: 2rem;
        }

        .contact-method {
            display: flex;
            gap: 1.5rem;
            margin-bottom: 2rem;
            align-items: flex-start;
        }

        .contact-icon {
            font-size: 1.5rem;
            min-width: 40px;
            color: var(--sage-500);
        }

        .contact-method h4 {
            margin-bottom: 0.5rem;
            color: white;
            font-size: 1.1rem;
        }

        .contact-method p {
            color: var(--sage-800);
            line-height: 1.4;
        }

        /* Contact Form */
        .contact-form {
            background: rgba(173, 174, 136, 0.1);
            backdrop-filter: blur(15px);
            padding: 2.5rem;
            border-radius: 20px;
            border: 1px solid rgba(173, 174, 136, 0.3);
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            color: white;
            font-weight: 500;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 1rem;
            border: 2px solid rgba(173, 174, 136, 0.3);
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 1rem;
            transition: border-color 0.3s ease;
        }

        .form-group input::placeholder,
        .form-group textarea::placeholder {
            color: rgba(255, 255, 255, 0.6);
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: var(--sage-500);
            background: rgba(173, 174, 136, 0.1);
        }

        .full-width {
            width: 100%;
        }

        .form-disclaimer {
            font-size: 0.9rem;
            color: rgba(255, 255, 255, 0.7);
            text-align: center;
            margin-top: 1rem;
            line-height: 1.4;
        }

        /* Footer */
        .footer {
            background: var(--black-200);
            color: var(--charcoal-800);
            padding: 4rem 0 2rem;
        }

        .footer-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 3rem;
            margin-bottom: 3rem;
        }

        .footer-section h4 {
            margin-bottom: 1.5rem;
            color: var(--sage-600);
            font-size: 1.2rem;
        }

        .footer-section ul {
            list-style: none;
        }

        .footer-section ul li {
            margin-bottom: 0.5rem;
        }

        .footer-section ul li a {
            color: var(--charcoal-700);
            text-decoration: none;
            transition: color 0.3s ease;
        }

        .footer-section ul li a:hover {
            color: var(--sage-500);
        }

        .footer-logo img {
            height: 60px;
            width: auto;
            margin-bottom: 1rem;
            filter: brightness(0) saturate(100%) invert(56%) sepia(6%) saturate(1282%) hue-rotate(68deg) brightness(94%) contrast(87%);
        }

        .footer-section p {
            color: var(--charcoal-700);
            line-height: 1.6;
        }

        .footer-bottom {
            border-top: 1px solid var(--charcoal-400);
            padding-top: 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .social-links {
            display: flex;
            gap: 1rem;
        }

        .social-links a {
            font-size: 1.5rem;
            text-decoration: none;
            transition: transform 0.3s ease;
        }

        .social-links a:hover {
            transform: scale(1.2);
        }

        /* Animations */
        .hero-cta {
            display: flex;
            gap: 1.5rem;
            justify-content: center;
            flex-wrap: wrap;
        }

        .scroll-indicator {
            position: absolute;
            bottom: 2rem;
            left: 50%;
            transform: translateX(-50%);
            color: var(--sage-500);
            animation: bounce 2s infinite;
        }

        .scroll-arrow {
            width: 2rem;
            height: 2rem;
            border-right: 2px solid var(--sage-500);
            border-bottom: 2px solid var(--sage-500);
            transform: rotate(45deg);
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% {
                transform: translateX(-50%) translateY(0);
            }
            40% {
                transform: translateX(-50%) translateY(-10px);
            }
            60% {
                transform: translateX(-50%) translateY(-5px);
            }
        }

        /* Loading */
        .loading {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, var(--charcoal-200) 0%, var(--outer-space-300) 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10000;
            transition: opacity 0.5s ease;
        }

        .loading.hidden {
            opacity: 0;
            pointer-events: none;
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 3px solid rgba(173, 174, 136, 0.3);
            border-top: 3px solid var(--sage-500);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Mobile Responsiveness */
        @media (max-width: 768px) {
            .container {
                padding: 0 1rem;
            }

            .hero-cta {
                flex-direction: column;
                align-items: center;
            }

            .about-grid,
            .benefits-content,
            .contact-content {
                grid-template-columns: 1fr;
                gap: 2rem;
            }

            .form-row {
                grid-template-columns: 1fr;
            }

            .process-timeline {
                grid-template-columns: 1fr;
            }

            .section {
                padding: 4rem 0;
            }

            .contact-form {
                padding: 1.5rem;
            }

            .footer-bottom {
                flex-direction: column;
                text-align: center;
            }

            .benefit-card {
                flex-direction: column;
                text-align: center;
            }

            .benefit-number {
                align-self: center;
            }
        }

        @media (max-width: 480px) {
            .spec-grid {
                grid-template-columns: 1fr;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>

    <!-- JavaScript -->
    <script>
        // Loading Animation
        window.addEventListener('load', function() {
            const loading = document.getElementById('loading');
            if (loading) {
                loading.classList.add('hidden');
                setTimeout(() => {
                    loading.remove();
                }, 500);
            }
        });

        // Navigation
        window.addEventListener('scroll', function() {
            const nav = document.getElementById('nav');
            
            if (window.scrollY > 100) {
                nav.classList.add('visible');
            } else {
                nav.classList.remove('visible');
            }
        });

        // Smooth scrolling
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    const offsetTop = target.offsetTop - 80;
                    window.scrollTo({
                        top: offsetTop,
                        behavior: 'smooth'
                    });
                }
            });
        });

        // Savings Calculator
        function updateCalculator() {
            const monthlyBill = document.getElementById('monthly-bill').value || 150;
            const annualSavings = Math.round(monthlyBill * 12 * 0.75);
            const totalSavings = Math.round(annualSavings * 25);
            
            document.getElementById('annual-savings').textContent = `£${annualSavings.toLocaleString()}`;
            document.getElementById('total-savings').textContent = `£${totalSavings.toLocaleString()}`;
        }

        document.getElementById('monthly-bill')?.addEventListener('input', updateCalculator);

        function openQuoteForm() {
            document.getElementById('contact').scrollIntoView({
                behavior: 'smooth',
                block: 'start'
            });
            
            const calculatorBill = document.getElementById('monthly-bill').value;
            if (calculatorBill) {
                document.getElementById('monthly-bill-form').value = calculatorBill;
            }
        }

        // Form Submission
        document.getElementById('quote-form')?.addEventListener('submit', function(e) {
            e.preventDefault();
            
            const name = document.getElementById('name').value.trim();
            const email = document.getElementById('email').value.trim();
            const phone = document.getElementById('phone').value.trim();
            const postcode = document.getElementById('postcode').value.trim();
            
            if (!name || !email || !phone || !postcode) {
                alert('Please fill in all required fields.');
                return;
            }
            
            if (!isValidEmail(email)) {
                alert('Please enter a valid email address.');
                return;
            }
            
            const submitBtn = this.querySelector('button[type="submit"]');
            const originalText = submitBtn.textContent;
            
            submitBtn.textContent = 'Sending...';
            submitBtn.disabled = true;
            
            setTimeout(() => {
                alert('Thank you! We\'ve received your quote request and will contact you within 24 hours to discuss your solar solution.');
                this.reset();
                submitBtn.textContent = originalText;
                submitBtn.disabled = false;
            }, 2000);
        });

        function isValidEmail(email) {
            return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);
        }

        // Mobile Menu
        document.getElementById('mobile-menu')?.addEventListener('click', function() {
            const navLinks = document.querySelector('.nav-links');
            navLinks.style.display = navLinks.style.display === 'flex' ? 'none' : 'flex';
        });

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            updateCalculator();
        });
    </script>

<!-- 🔒 SECURE Green Star Solar VAPI Chat Widget - Production Version -->
<!-- ANTI-TAMPERING: This widget includes security measures to prevent unauthorized modification -->
<!-- Paste this entire code block before your </body> tag -->

<style>
/* VAPI Widget CSS Variables - Obfuscated */
:root {
  --vapi-primary-color: rgba(173, 174, 136, 1);
  --vapi-secondary-color: rgba(44, 52, 33, 1); 
  --vapi-accent-color: #ffffff;
  --vapi-dark: linear-gradient(145deg, rgba(68, 76, 92, 0.95), rgba(75, 89, 97, 0.9));
  --vapi-glass-border: rgba(173, 174, 136, 0.3);
}

#vapi-hybrid-widget {
    position: fixed;
    bottom: 30px;
    right: 30px;
    z-index: 10000;
    font-family: Poppins, "Poppins Fallback", sans-serif;
    user-select: none;
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
}

/* Prevent text selection and context menu */
#vapi-hybrid-widget * {
    user-select: none !important;
    -webkit-user-select: none !important;
    -moz-user-select: none !important;
    -ms-user-select: none !important;
    -webkit-touch-callout: none !important;
    -webkit-tap-highlight-color: transparent !important;
}

#vapi-tooltip {
    position: absolute;
    bottom: 85px;
    right: 0;
    background: linear-gradient(135deg, 
        rgba(173, 174, 136, 0.95), 
        rgba(44, 52, 33, 0.9)) !important;
    backdrop-filter: blur(20px) saturate(180%) !important;
    color: var(--vapi-accent-color) !important;
    padding: 12px 16px !important;
    border-radius: 15px !important;
    font-size: 14px !important;
    font-weight: 500 !important;
    white-space: nowrap !important;
    opacity: 0 !important;
    transform: translateY(10px) scale(0.8) !important;
    transition: all 0.4s cubic-bezier(0.23, 1, 0.32, 1) !important;
    pointer-events: none !important;
    box-shadow: 
        0 8px 32px rgba(173, 174, 136, 0.3),
        0 4px 16px rgba(0, 0, 0, 0.1),
        inset 0 1px 0 rgba(255, 255, 255, 0.2) !important;
    border: 1px solid rgba(173, 174, 136, 0.3) !important;
}

#vapi-tooltip::after {
    content: '' !important;
    position: absolute !important;
    bottom: -6px !important;
    right: 20px !important;
    width: 0 !important;
    height: 0 !important;
    border-left: 6px solid transparent !important;
    border-right: 6px solid transparent !important;
    border-top: 6px solid rgba(173, 174, 136, 0.95) !important;
    filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.1)) !important;
}

#vapi-hybrid-widget:hover #vapi-tooltip {
    opacity: 1 !important;
    transform: translateY(0) scale(1) !important;
}

#vapi-hybrid-widget:hover #vapi-chat-panel.open ~ #vapi-tooltip,
#vapi-chat-panel.open ~ #vapi-tooltip {
    opacity: 0 !important;
    transform: translateY(10px) scale(0.8) !important;
}

#vapi-hybrid-widget *,
#vapi-hybrid-widget *::before,
#vapi-hybrid-widget *::after {
    box-sizing: border-box;
}

#vapi-speech-bubble {
    display: none !important;
}

#vapi-chat-button {
    width: 70px !important;
    height: 70px !important;
    border-radius: 50% !important;
    background: var(--vapi-dark) !important;
    border: 1px solid var(--vapi-glass-border) !important;
    cursor: pointer !important;
    box-shadow: 
      0 24px 48px rgba(173, 174, 136, 0.2),
      0 12px 24px rgba(0, 0, 0, 0.15),
      inset 0 1px 0 var(--vapi-glass-border),
      0 0 40px rgba(173, 174, 136, 0.1) !important;
    backdrop-filter: blur(30px) saturate(200%) !important;
    transition: all 0.5s cubic-bezier(0.23, 1, 0.32, 1) !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    outline: none !important;
    user-select: none !important;
    position: relative !important;
}

#vapi-chat-button::before {
    content: '' !important;
    position: absolute !important;
    top: -2px !important;
    left: -2px !important;
    right: -2px !important;
    bottom: -2px !important;
    border-radius: 50% !important;
    background: linear-gradient(45deg, var(--vapi-primary-color), var(--vapi-secondary-color)) !important;
    z-index: -1 !important;
    opacity: 0 !important;
    transition: opacity 0.3s ease !important;
}

#vapi-chat-button:hover::before {
    opacity: 0.7 !important;
}

#vapi-chat-button:hover {
    transform: translateY(-3px) scale(1.05) !important;
    box-shadow: 
      0 32px 64px rgba(173, 174, 136, 0.25),
      0 16px 32px rgba(0, 0, 0, 0.2),
      inset 0 1px 0 rgba(255, 255, 255, 0.3),
      0 0 50px rgba(173, 174, 136, 0.15) !important;
}

#vapi-chat-button:active {
    transform: translateY(-1px) scale(1.02) !important;
    transition: all 0.1s ease !important;
}

#vapi-chat-panel {
    position: absolute !important;
    bottom: 85px !important;
    right: 0 !important;
    width: 420px !important;
    height: 600px !important;
    background: var(--vapi-dark) !important;
    backdrop-filter: blur(30px) saturate(200%) !important;
    border-radius: 20px !important;
    border: 1px solid var(--vapi-glass-border) !important;
    box-shadow: 
      0 32px 64px rgba(173, 174, 136, 0.15),
      0 16px 32px rgba(0, 0, 0, 0.2),
      inset 0 1px 0 var(--vapi-glass-border) !important;
    opacity: 0 !important;
    transform: translateY(20px) scale(0.95) !important;
    transition: all 0.4s cubic-bezier(0.23, 1, 0.32, 1) !important;
    pointer-events: none !important;
    display: flex !important;
    flex-direction: column !important;
    overflow: hidden !important;
    font-family: inherit !important;
}

#vapi-chat-panel.open {
    opacity: 1 !important;
    transform: translateY(0) scale(1) !important;
    pointer-events: all !important;
}

#vapi-chat-header {
    padding: 25px 30px !important;
    background: linear-gradient(135deg, rgba(173, 174, 136, 0.95), rgba(44, 52, 33, 0.85)) !important;
    color: var(--vapi-accent-color) !important;
    display: flex !important;
    justify-content: space-between !important;
    align-items: center !important;
    border-bottom: 1px solid var(--vapi-glass-border) !important;
    backdrop-filter: blur(10px) !important;
}

#vapi-chat-title {
    margin: 0 !important;
    font-size: 18px !important;
    font-weight: 700 !important;
    letter-spacing: 0.5px !important;
    text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3) !important;
}

#vapi-close-button {
    background: rgba(255, 255, 255, 0.15) !important;
    border: 1px solid rgba(255, 255, 255, 0.2) !important;
    border-radius: 50% !important;
    width: 32px !important;
    height: 32px !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    cursor: pointer !important;
    font-size: 18px !important;
    font-weight: bold !important;
    color: var(--vapi-accent-color) !important;
    transition: all 0.3s ease !important;
    outline: none !important;
    user-select: none !important;
}

#vapi-close-button:hover {
    background: rgba(255, 255, 255, 0.25) !important;
    transform: rotate(90deg) !important;
}

#vapi-text-messages, #vapi-voice-messages {
    flex: 1 !important;
    padding: 25px 30px !important;
    overflow-y: auto !important;
    display: flex !important;
    flex-direction: column !important;
    gap: 15px !important;
}

#vapi-voice-messages {
    display: none !important;
}

.vapi-message {
    margin-bottom: 20px !important;
    padding: 16px 20px !important;
    border-radius: 18px !important;
    max-width: 85% !important;
    word-wrap: break-word !important;
    line-height: 1.5 !important;
    position: relative !important;
    font-size: 14px !important;
}

.vapi-message-user {
    background: linear-gradient(135deg, rgba(173, 174, 136, 0.9), rgba(44, 52, 33, 0.8)) !important;
    color: var(--vapi-accent-color) !important;
    margin-left: auto !important;
    border-bottom-right-radius: 8px !important;
    box-shadow: 0 4px 12px rgba(173, 174, 136, 0.3) !important;
}

.vapi-message-assistant {
    background: rgba(255, 255, 255, 0.12) !important;
    color: var(--vapi-accent-color) !important;
    border-left: 4px solid var(--vapi-primary-color) !important;
    border-bottom-left-radius: 8px !important;
    backdrop-filter: blur(10px) !important;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1) !important;
}

.vapi-message-system {
    background: rgba(255, 225, 77, 0.15) !important;
    color: var(--vapi-secondary-color) !important;
    text-align: center !important;
    font-size: 13px !important;
    font-style: italic !important;
    margin: 12px auto !important;
    backdrop-filter: blur(5px) !important;
}

.vapi-voice-message {
    margin-bottom: 20px !important;
    padding: 16px 20px !important;
    border-radius: 18px !important;
    max-width: 85% !important;
    word-wrap: break-word !important;
    line-height: 1.5 !important;
    position: relative !important;
    font-size: 14px !important;
}

.vapi-voice-message-user {
    background: linear-gradient(135deg, rgba(173, 174, 136, 0.9), rgba(44, 52, 33, 0.8)) !important;
    color: var(--vapi-accent-color) !important;
    margin-left: auto !important;
    border-bottom-right-radius: 8px !important;
    box-shadow: 0 4px 12px rgba(173, 174, 136, 0.3) !important;
}

.vapi-voice-message-assistant {
    background: rgba(255, 255, 255, 0.12) !important;
    color: var(--vapi-accent-color) !important;
    border: 1px solid rgba(173, 174, 136, 0.3) !important;
    border-left: 4px solid var(--vapi-primary-color) !important;
    border-bottom-left-radius: 8px !important;
    backdrop-filter: blur(10px) !important;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1) !important;
}

.vapi-voice-message-system {
    background: rgba(255, 225, 77, 0.15) !important;
    color: var(--vapi-secondary-color) !important;
    text-align: center !important;
    font-size: 13px !important;
    font-style: italic !important;
    margin: 12px auto !important;
    backdrop-filter: blur(5px) !important;
}

#vapi-input-area {
    padding: 25px 30px !important;
    border-top: 1px solid var(--vapi-glass-border) !important;
    background: rgba(255, 255, 255, 0.03) !important;
    backdrop-filter: blur(10px) !important;
}

#vapi-mode-toggle {
    display: flex !important;
    margin-bottom: 20px !important;
    padding: 4px !important;
    background: rgba(255, 255, 255, 0.05) !important;
    border-radius: 12px !important;
    border: 1px solid var(--vapi-glass-border) !important;
    backdrop-filter: blur(5px) !important;
}

.vapi-mode-button {
    flex: 1 !important;
    padding: 12px 16px !important;
    background: transparent !important;
    border: none !important;
    border-radius: 8px !important;
    color: rgba(255, 255, 255, 0.7) !important;
    font-size: 14px !important;
    font-weight: 500 !important;
    cursor: pointer !important;
    transition: all 0.3s ease !important;
    outline: none !important;
    user-select: none !important;
}

.vapi-mode-button:hover {
    background: rgba(255, 255, 255, 0.1) !important;
    color: var(--vapi-accent-color) !important;
}

.vapi-mode-button.active {
    background: linear-gradient(135deg, var(--vapi-primary-color), var(--vapi-secondary-color)) !important;
    color: var(--vapi-accent-color) !important;
    box-shadow: 0 4px 12px rgba(173, 174, 136, 0.3) !important;
}

#vapi-text-input-container {
    display: flex !important;
    gap: 12px !important;
    align-items: center !important;
}

#vapi-message-input {
    flex: 1 !important;
    padding: 14px 18px !important;
    background: rgba(255, 255, 255, 0.08) !important;
    border: 1px solid var(--vapi-glass-border) !important;
    border-radius: 12px !important;
    color: var(--vapi-accent-color) !important;
    font-size: 14px !important;
    outline: none !important;
    backdrop-filter: blur(10px) !important;
    transition: all 0.3s ease !important;
}

#vapi-message-input::placeholder {
    color: rgba(255, 255, 255, 0.5) !important;
}

#vapi-message-input:focus {
    border-color: var(--vapi-primary-color) !important;
    box-shadow: 0 0 0 3px rgba(173, 174, 136, 0.2) !important;
    background: rgba(255, 255, 255, 0.12) !important;
}

#vapi-send-button {
    padding: 14px 20px !important;
    background: linear-gradient(135deg, var(--vapi-primary-color), var(--vapi-secondary-color)) !important;
    border: none !important;
    border-radius: 12px !important;
    color: var(--vapi-accent-color) !important;
    font-size: 14px !important;
    font-weight: 600 !important;
    cursor: pointer !important;
    transition: all 0.3s ease !important;
    outline: none !important;
    user-select: none !important;
    box-shadow: 0 4px 12px rgba(173, 174, 136, 0.3) !important;
}

#vapi-send-button:hover {
    transform: translateY(-2px) !important;
    box-shadow: 0 6px 16px rgba(173, 174, 136, 0.4) !important;
}

#vapi-send-button:active {
    transform: translateY(0) !important;
}

#vapi-voice-controls {
    display: none !important;
    text-align: center !important;
}

#vapi-voice-button {
    padding: 16px 24px !important;
    background: linear-gradient(135deg, rgba(173, 174, 136, 0.9), rgba(44, 52, 33, 0.8)) !important;
    border: 1px solid rgba(173, 174, 136, 0.3) !important;
    border-radius: 12px !important;
    color: var(--vapi-accent-color) !important;
    font-size: 14px !important;
    font-weight: 600 !important;
    cursor: pointer !important;
    transition: all 0.3s ease !important;
    outline: none !important;
    user-select: none !important;
    box-shadow: 0 4px 12px rgba(173, 174, 136, 0.3) !important;
}

#vapi-voice-button:hover {
    transform: translateY(-2px) !important;
    box-shadow: 0 6px 16px rgba(173, 174, 136, 0.4) !important;
}

#vapi-voice-button.active {
    background: linear-gradient(135deg, rgba(220, 38, 38, 0.9), rgba(153, 27, 27, 0.8)) !important;
    border-color: rgba(220, 38, 38, 0.5) !important;
    box-shadow: 0 4px 12px rgba(220, 38, 38, 0.3) !important;
    animation: pulse 2s infinite !important;
}

@keyframes pulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.7; }
}

/* ⚡ ULTRA MOBILE OPTIMIZATION - SECURE EDITION */
/* Professional Dynamic Experience with Enhanced Security */

/* TABLET AND MOBILE FOUNDATION (up to 768px) */
@media (max-width: 768px) {
    #vapi-hybrid-widget {
        bottom: 20px !important;
        right: 20px !important;
        /* Universal hardware acceleration */
        -webkit-transform: translate3d(0, 0, 0) !important;
        transform: translate3d(0, 0, 0) !important;
        -webkit-backface-visibility: hidden !important;
        backface-visibility: hidden !important;
        z-index: 999999 !important;
    }

    #vapi-tooltip {
        bottom: 75px !important;
        font-size: 13px !important;
        padding: 10px 14px !important;
        /* Enhanced mobile performance */
        -webkit-transform: translateZ(0) !important;
        transform: translateZ(0) !important;
        transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94) !important;
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15) !important;
        backdrop-filter: blur(10px) !important;
    }
    
    #vapi-hybrid-widget:hover #vapi-tooltip {
        opacity: 1 !important;
        transform: scale(1) translateY(0) !important;
    }

    #vapi-chat-button {
        width: 70px !important;
        height: 70px !important;
        /* Touch-friendly sizing maintained */
        min-width: 70px !important;
        min-height: 70px !important;
        /* Performance optimizations */
        -webkit-transform: translateZ(0) !important;
        transform: translateZ(0) !important;
    }

    #vapi-chat-button img {
        width: 42px !important;
        height: 42px !important;
    }

    #vapi-chat-panel {
        width: calc(100vw - 40px) !important;
        height: 85vh !important;
        max-height: 550px !important;
        bottom: 90px !important;
        right: 20px !important;
        border-radius: 20px !important;
        /* Enhanced mobile performance */
        -webkit-transform: translateZ(0) !important;
        transform: translateZ(0) !important;
        -webkit-overflow-scrolling: touch !important;
        overflow-y: auto !important;
    }

    #vapi-chat-header {
        padding: 20px 25px !important;
        -webkit-transform: translateZ(0) !important;
        transform: translateZ(0) !important;
    }

    #vapi-chat-title {
        font-size: 18px !important;
    }

    #vapi-text-messages, #vapi-voice-messages {
        padding: 20px 25px !important;
        /* Fix scrolling performance */
        -webkit-transform: translateZ(0) !important;
        transform: translateZ(0) !important;
        position: relative !important;
    }

    .vapi-message, .vapi-voice-message {
        max-width: 85% !important;
        font-size: 14px !important;
        padding: 14px 18px !important;
        border-radius: 16px !important;
        /* Performance optimization */
        -webkit-transform: translateZ(0) !important;
        transform: translateZ(0) !important;
    }

    #vapi-mode-toggle {
        margin-bottom: 15px !important;
        padding: 4px !important;
        border-radius: 12px !important;
    }

    .vapi-mode-button {
        padding: 12px 16px !important;
        font-size: 13px !important;
        border-radius: 8px !important;
        /* Touch-friendly sizing */
        min-height: 44px !important;
        touch-action: manipulation !important;
    }

    #vapi-input-area {
        padding: 20px 25px !important;
        -webkit-transform: translateZ(0) !important;
        transform: translateZ(0) !important;
    }

    #vapi-message-input {
        padding: 14px 18px !important;
        font-size: 16px !important;
        border-radius: 12px !important;
        /* Prevent zoom on iOS */
        -webkit-appearance: none !important;
        appearance: none !important;
        /* Touch optimization */
        touch-action: manipulation !important;
        min-height: 44px !important;
    }

    #vapi-send-button {
        padding: 14px 20px !important;
        font-size: 14px !important;
        border-radius: 12px !important;
        /* Touch-friendly minimum size */
        min-width: 60px !important;
        min-height: 44px !important;
        touch-action: manipulation !important;
    }

    #vapi-voice-button {
        padding: 16px 24px !important;
        font-size: 14px !important;
        border-radius: 12px !important;
        /* Touch optimization */
        min-height: 44px !important;
        touch-action: manipulation !important;
    }
}

/* SAFARI-SPECIFIC MOBILE OPTIMIZATIONS */
@media (max-width: 768px) and (-webkit-min-device-pixel-ratio: 1) {
    #vapi-hybrid-widget {
        /* Safari-specific hardware acceleration */
        -webkit-transform: translate3d(0, 0, 0) !important;
        transform: translate3d(0, 0, 0) !important;
        -webkit-backface-visibility: hidden !important;
        backface-visibility: hidden !important;
    }
    
    #vapi-chat-panel {
        /* Enhanced Safari support */
        -webkit-backdrop-filter: blur(30px) saturate(150%) !important;
        backdrop-filter: blur(30px) saturate(150%) !important;
        background: var(--vapi-dark) !important;
        -webkit-overflow-scrolling: touch !important;
        position: fixed !important;
    }
    
    #vapi-text-messages, #vapi-voice-messages {
        /* Fix Safari scrolling issues */
        -webkit-transform: translateZ(0) !important;
        transform: translateZ(0) !important;
        -webkit-overflow-scrolling: touch !important;
    }
    
    #vapi-input-area {
        /* Safari input optimization */
        -webkit-transform: translateZ(0) !important;
        transform: translateZ(0) !important;
        position: relative !important;
        z-index: 10 !important;
    }
    
    #vapi-message-input {
        /* Safari input fix */
        -webkit-appearance: none !important;
        -webkit-border-radius: 12px !important;
        border-radius: 12px !important;
    }
}

/* LANDSCAPE ORIENTATION SUPPORT */
@media (max-width: 768px) and (orientation: landscape) {
    #vapi-chat-panel {
        height: 90vh !important;
        max-height: 400px !important;
        width: calc(100vw - 40px) !important;
    }
    
    #vapi-text-messages, #vapi-voice-messages {
        padding: 15px 20px !important;
        max-height: 200px !important;
        overflow-y: auto !important;
        -webkit-overflow-scrolling: touch !important;
    }
    
    #vapi-input-area {
        padding: 15px 20px !important;
    }
}

/* SMALL MOBILE SPECIFIC (480px and below) */
@media (max-width: 480px) {
    #vapi-hybrid-widget {
        bottom: 15px !important;
        right: 15px !important;
    }

    #vapi-chat-panel {
        width: calc(100vw - 30px) !important;
        height: 80vh !important;
        max-height: 500px !important;
        bottom: 75px !important;
        right: 15px !important;
        border-radius: 18px !important;
        /* Enhanced small screen performance */
        contain: layout style paint !important;
    }

    #vapi-chat-button {
        width: 60px !important;
        height: 60px !important;
        /* Maintain touch-friendly size */
        min-width: 60px !important;
        min-height: 60px !important;
    }

    #vapi-chat-button img {
        width: 36px !important;
        height: 36px !important;
    }

    #vapi-tooltip {
        bottom: 65px !important;
        font-size: 12px !important;
        padding: 8px 12px !important;
        max-width: 150px !important;
        white-space: nowrap !important;
        overflow: hidden !important;
        text-overflow: ellipsis !important;
    }

    #vapi-text-messages, #vapi-voice-messages {
        padding: 15px 18px !important;
        /* Small screen scroll optimization */
        scrollbar-width: thin !important;
    }

    #vapi-input-area {
        padding: 15px 18px !important;
    }

    #vapi-chat-header {
        padding: 15px 18px !important;
        /* Flexible header for small screens */
        flex-wrap: wrap !important;
        gap: 8px !important;
    }

    #vapi-chat-title {
        font-size: 16px !important;
        flex-shrink: 1 !important;
        min-width: 0 !important;
        overflow: hidden !important;
        text-overflow: ellipsis !important;
    }

    #vapi-close-button {
        flex-shrink: 0 !important;
        width: 32px !important;
        height: 32px !important;
        min-width: 32px !important;
        min-height: 32px !important;
    }

    .vapi-message, .vapi-voice-message {
        max-width: 90% !important;
        font-size: 13px !important;
        padding: 12px 15px !important;
        border-radius: 14px !important;
        line-height: 1.4 !important;
    }
    
    #vapi-message-input {
        font-size: 16px !important;
        padding: 12px 16px !important;
        border-radius: 12px !important;
        /* Maintain minimum height for touch */
        min-height: 44px !important;
    }
    
    #vapi-send-button {
        padding: 12px 16px !important;
        font-size: 13px !important;
        border-radius: 12px !important;
        min-width: 50px !important;
        min-height: 44px !important;
    }
    
    #vapi-voice-button {
        padding: 14px 20px !important;
        font-size: 13px !important;
        border-radius: 12px !important;
        min-height: 44px !important;
    }
    
    .vapi-mode-button {
        padding: 10px 12px !important;
        font-size: 12px !important;
        border-radius: 8px !important;
        min-height: 40px !important;
    }
}

/* EXTRA SMALL SCREENS (320px and below) */
@media screen and (max-width: 320px) {
    #vapi-chat-panel {
        width: calc(100vw - 20px) !important;
        right: 10px !important;
        bottom: 70px !important;
        border-radius: 16px !important;
    }
    
    #vapi-hybrid-widget {
        bottom: 12px !important;
        right: 12px !important;
    }
    
    #vapi-chat-button {
        width: 56px !important;
        height: 56px !important;
    }
    
    #vapi-chat-button img {
        width: 32px !important;
        height: 32px !important;
    }
    
    #vapi-tooltip {
        bottom: 60px !important;
        font-size: 11px !important;
        padding: 6px 10px !important;
        max-width: 120px !important;
    }
    
    #vapi-text-messages, #vapi-voice-messages {
        padding: 12px 15px !important;
    }
    
    #vapi-input-area {
        padding: 12px 15px !important;
    }
    
    #vapi-chat-header {
        padding: 12px 15px !important;
    }
    
    #vapi-chat-title {
        font-size: 15px !important;
    }
    
    .vapi-message, .vapi-voice-message {
        font-size: 12px !important;
        padding: 10px 12px !important;
        border-radius: 12px !important;
    }
}

/* HIGH DPI MOBILE DISPLAYS */
@media (max-width: 768px) and (-webkit-min-device-pixel-ratio: 2) {
    #vapi-chat-button img {
        image-rendering: -webkit-optimize-contrast !important;
        image-rendering: crisp-edges !important;
    }
    
    .vapi-message, .vapi-voice-message {
        -webkit-font-smoothing: antialiased !important;
        -moz-osx-font-smoothing: grayscale !important;
    }
}

/* TOUCH DEVICE OPTIMIZATIONS */
@media (hover: none) and (pointer: coarse) {
    #vapi-chat-button:hover {
        /* Override hover effects for touch devices */
        transform: translateY(-8px) scale(1.05) !important;
    }
    
    #vapi-send-button:hover,
    #vapi-voice-button:hover,
    .vapi-mode-button:hover {
        /* Maintain touch feedback without hover effects */
        transform: scale(1.02) !important;
    }
    
    #vapi-message-input {
        /* Enhanced touch input */
        -webkit-tap-highlight-color: transparent !important;
        tap-highlight-color: transparent !important;
    }
}

/* PERFORMANCE OPTIMIZATIONS FOR ALL MOBILE */
@media (max-width: 768px) {
    #vapi-hybrid-widget,
    #vapi-chat-panel,
    #vapi-text-messages,
    #vapi-voice-messages,
    #vapi-input-area {
        /* GPU acceleration for smooth performance */
        -webkit-transform: translateZ(0) !important;
        transform: translateZ(0) !important;
        will-change: transform !important;
    }
    
    .vapi-message,
    .vapi-voice-message {
        /* Optimize message rendering */
        contain: content !important;
    }
    
    #vapi-chat-panel.open {
        /* Smooth opening animation */
        animation: secureMobileSlideUp 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards !important;
    }
}

@keyframes secureMobileSlideUp {
    from {
        opacity: 0;
        transform: translateY(30px) scale(0.95);
    }
    to {
        opacity: 1;
        transform: translateY(0) scale(1);
    }
}
</style>

<!-- Widget HTML Structure -->
<div id="vapi-hybrid-widget">
  <div id="vapi-tooltip">Chat with Sophie</div>
  
  <button id="vapi-chat-button">
    <img 
      src="https://cdn.shopify.com/s/files/1/0951/6141/8067/files/0x0_2_1.png?v=1756897984" 
      alt="Green Star Solar"
      loading="eager"
      style="object-fit: contain; width: 42px; height: 42px;"
    />
  </button>

  <!-- Ultra-Premium Sophie Chat Panel -->
  <div id="vapi-chat-panel" role="dialog" aria-labelledby="vapi-chat-title" class="vapi-text-mode">
    <!-- Elegant Header -->
    <div id="vapi-chat-header">
      <div style="display: flex; align-items: center; gap: 10px;">
        <img src="https://cdn.shopify.com/s/files/1/0951/6141/8067/files/0x0_2_1.png?v=1756897984" alt="Logo" style="width: 24px; height: 24px; filter: brightness(0) invert(1);">
        <h3 id="vapi-chat-title">Sophie • Green Star Assistant</h3>
      </div>
      <button id="vapi-close-button" aria-label="Close">×</button>
    </div>

    <!-- Messages -->
    <div id="vapi-text-messages" role="log" aria-live="polite">
      <div class="vapi-message vapi-message-assistant">
        Hi! I'm Sophie, your Green Star assistant. I'm here to help you discover how solar energy can transform your home or business. What would you like to know about our solar solutions?
      </div>
    </div>

    <div id="vapi-voice-messages" role="log" aria-live="polite"></div>

    <!-- Ultra-Premium Input Area -->
    <div id="vapi-input-area">
      <!-- Mode Toggle -->
      <div id="vapi-mode-toggle">
        <button class="vapi-mode-button active" data-mode="text">Text Chat</button>
        <button class="vapi-mode-button" data-mode="voice">Voice Call</button>
      </div>

      <!-- Text Input -->
      <div id="vapi-text-input-container">
        <input
          id="vapi-message-input"
          type="text"
          placeholder="Ask Sophie..."
          aria-label="Message to Sophie"
          autocomplete="off"
          maxlength="500"
        >
        <button id="vapi-send-button" aria-label="Send message">Send</button>
      </div>

      <!-- Voice Controls -->
      <div id="vapi-voice-controls">
        <button id="vapi-voice-button" aria-label="Start voice call with Sophie">Start Call</button>
      </div>
    </div>
  </div>
</div>

<script>
// 🔧 VAPI Web Integration - Proper Implementation
(function() {
  'use strict';
  
  // Configuration with your credentials
  const CONFIG = {
    publicKey: 'b3f38fb7-8541-4e3e-8708-5d49c3f54f00',
    assistantId: 'cb76e1bc-dc2d-4ea8-84a1-c17499ed6387'
  };
  
  // Widget state
  let widgetState = {
    isOpen: false,
    currentMode: 'text',
    isVoiceActive: false,
    vapiInstance: null
  };
  
  // Elements cache
  const elements = {
    button: document.getElementById('vapi-chat-button'),
    panel: document.getElementById('vapi-chat-panel'),
    closeButton: document.getElementById('vapi-close-button'),
    textMessages: document.getElementById('vapi-text-messages'),
    voiceMessages: document.getElementById('vapi-voice-messages'),
    messageInput: document.getElementById('vapi-message-input'),
    sendButton: document.getElementById('vapi-send-button'),
    voiceButton: document.getElementById('vapi-voice-button'),
    modeButtons: document.querySelectorAll('.vapi-mode-button'),
    textInputContainer: document.getElementById('vapi-text-input-container'),
    voiceControls: document.getElementById('vapi-voice-controls')
  };
  
  // Initialize VAPI using the HTML script tag method
  function initializeVapi() {
    const script = document.createElement('script');
    script.src = 'https://cdn.jsdelivr.net/gh/VapiAI/html-script-tag@latest/dist/assets/index.js';
    script.defer = true;
    script.async = true;
    
    script.onload = function() {
      try {
        if (window.vapiSDK) {
          widgetState.vapiInstance = window.vapiSDK.run({
            apiKey: CONFIG.publicKey,
            assistant: CONFIG.assistantId,
            config: {
              showButton: false, // We have our own button
              position: 'bottom-right',
              offset: '20px',
              width: '50px',
              height: '50px'
            }
          });
          console.log('✅ VAPI initialized successfully');
          setupVoiceEventListeners();
        }
      } catch (error) {
        console.error('VAPI initialization failed:', error);
        addVoiceMessage('Voice service unavailable. Please try text chat.', 'system');
      }
    };
    
    document.head.appendChild(script);
  }
  
  function setupVoiceEventListeners() {
    if (!widgetState.vapiInstance) return;
    
    // Set up VAPI event listeners
    widgetState.vapiInstance.on('call-start', () => {
      widgetState.isVoiceActive = true;
      elements.voiceButton.className = 'active';
      elements.voiceButton.textContent = 'End Call';
      addVoiceMessage('Call started. Speak now...', 'system');
      console.log('Voice call started');
    });
    
    widgetState.vapiInstance.on('call-end', () => {
      widgetState.isVoiceActive = false;
      elements.voiceButton.className = '';
      elements.voiceButton.textContent = 'Start Call';
      addVoiceMessage('Call ended.', 'system');
      console.log('Voice call ended');
    });
    
    widgetState.vapiInstance.on('speech-start', () => {
      addVoiceMessage('Listening...', 'system');
    });
    
    widgetState.vapiInstance.on('speech-end', (data) => {
      if (data?.transcript) {
        addVoiceMessage(data.transcript, 'user');
      }
    });
    
    widgetState.vapiInstance.on('message', (message) => {
      console.log('VAPI message:', message);
      if (message?.type === 'transcript' && message?.transcript) {
        if (message.role === 'assistant') {
          addVoiceMessage(message.transcript, 'assistant');
        }
      }
    });
    
    widgetState.vapiInstance.on('error', (error) => {
      console.error('VAPI Error:', error);
      addVoiceMessage('An error occurred. Please try again.', 'system');
      if (widgetState.isVoiceActive) {
        endVoiceCall();
      }
    });
  }
  
  function setupEventListeners() {
    // Widget open/close
    elements.button?.addEventListener('click', toggleWidget);
    elements.closeButton?.addEventListener('click', closeWidget);
    
    // Mode switching
    elements.modeButtons.forEach(button => {
      button.addEventListener('click', () => switchMode(button.dataset.mode));
    });
    
    // Text chat
    elements.sendButton?.addEventListener('click', handleSendMessage);
    elements.messageInput?.addEventListener('keypress', function(e) {
      if (e.key === 'Enter' && !e.shiftKey) {
        e.preventDefault();
        handleSendMessage();
      }
    });
    
    // Voice chat
    elements.voiceButton?.addEventListener('click', handleVoiceToggle);
    
    // Close on outside click
    document.addEventListener('click', function(e) {
      if (widgetState.isOpen && !e.target.closest('#vapi-hybrid-widget')) {
        closeWidget();
      }
    });
  }
  
  function toggleWidget() {
    if (widgetState.isOpen) {
      closeWidget();
    } else {
      openWidget();
    }
  }
  
  function openWidget() {
    widgetState.isOpen = true;
    elements.panel?.classList.add('open');
    if (widgetState.currentMode === 'text') {
      elements.messageInput?.focus();
    }
  }
  
  function closeWidget() {
    widgetState.isOpen = false;
    elements.panel?.classList.remove('open');
    
    if (widgetState.isVoiceActive) {
      endVoiceCall();
    }
  }
  
  function switchMode(mode) {
    if (mode === widgetState.currentMode) return;
    
    widgetState.currentMode = mode;
    
    // Update UI
    elements.modeButtons.forEach(btn => btn.classList.remove('active'));
    document.querySelector(`[data-mode="${mode}"]`)?.classList.add('active');
    
    if (mode === 'text') {
      elements.textMessages.style.display = 'flex';
      elements.voiceMessages.style.display = 'none';
      elements.textInputContainer.style.display = 'flex';
      elements.voiceControls.style.display = 'none';
      elements.panel?.classList.add('vapi-text-mode');
      elements.panel?.classList.remove('vapi-voice-mode');
      elements.messageInput?.focus();
    } else {
      elements.textMessages.style.display = 'none';
      elements.voiceMessages.style.display = 'flex';
      elements.textInputContainer.style.display = 'none';
      elements.voiceControls.style.display = 'block';
      elements.panel?.classList.add('vapi-voice-mode');
      elements.panel?.classList.remove('vapi-text-mode');
    }
  }
  
  function handleSendMessage() {
    const message = elements.messageInput?.value?.trim();
    if (!message) return;
    
    elements.messageInput.value = '';
    addTextMessage(message, 'user');
    showTypingIndicator();
    
    // Simulate response for text chat (you can connect this to your backend)
    setTimeout(() => {
      hideTypingIndicator();
      const responses = [
        "Thanks for your message! I'd be happy to help you with solar panel information.",
        "Great question! Our solar panels can significantly reduce your electricity bills.",
        "I can help you learn more about our solar solutions. What specific information are you looking for?"
      ];
      const response = responses[Math.floor(Math.random() * responses.length)];
      addTextMessage(response, 'assistant');
    }, 1000);
  }
  
  function handleVoiceToggle() {
    if (widgetState.isVoiceActive) {
      endVoiceCall();
    } else {
      startVoiceCall();
    }
  }
  
  function startVoiceCall() {
    if (!widgetState.vapiInstance) {
      addVoiceMessage('Voice service is initializing. Please try again in a moment.', 'system');
      return;
    }
    
    try {
      console.log('Starting voice call with assistant:', CONFIG.assistantId);
      widgetState.vapiInstance.start(CONFIG.assistantId);
    } catch (error) {
      console.error('Failed to start voice call:', error);
      addVoiceMessage('Failed to start call. Please try again.', 'system');
    }
  }
  
  function endVoiceCall() {
    try {
      if (widgetState.vapiInstance) {
        widgetState.vapiInstance.stop();
      }
      widgetState.isVoiceActive = false;
      elements.voiceButton.className = '';
      elements.voiceButton.textContent = 'Start Call';
    } catch (error) {
      console.error('Failed to end voice call:', error);
    }
  }
  
  function addTextMessage(text, sender) {
    const messageDiv = document.createElement('div');
    messageDiv.className = `vapi-message vapi-message-${sender}`;
    messageDiv.textContent = text;
    elements.textMessages?.appendChild(messageDiv);
    scrollToBottom(elements.textMessages);
  }
  
  function addVoiceMessage(text, sender) {
    const messageDiv = document.createElement('div');
    messageDiv.className = `vapi-voice-message vapi-voice-message-${sender}`;
    messageDiv.textContent = text;
    elements.voiceMessages?.appendChild(messageDiv);
    scrollToBottom(elements.voiceMessages);
  }
  
  function showTypingIndicator() {
    hideTypingIndicator();
    
    const typingDiv = document.createElement('div');
    typingDiv.id = 'vapi-typing-indicator';
    typingDiv.className = 'vapi-message vapi-message-assistant';
    typingDiv.textContent = 'Sophie is typing...';
    
    elements.textMessages?.appendChild(typingDiv);
    scrollToBottom(elements.textMessages);
  }
  
  function hideTypingIndicator() {
    const indicator = document.getElementById('vapi-typing-indicator');
    if (indicator) {
      indicator.remove();
    }
  }
  
  function scrollToBottom(element) {
    if (element) {
      element.scrollTop = element.scrollHeight;
    }
  }
  
  // Initialize everything
  function initialize() {
    setupEventListeners();
    initializeVapi();
    console.log('Widget initialized with VAPI integration');
  }
  
  // Start when DOM is ready
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initialize);
  } else {
    initialize();
  }
  
})();
</script>
</body>
</html>